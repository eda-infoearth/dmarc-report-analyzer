import{h as de,t as a,D,k as l,w as ce,F as M,m as N,e as u,b as I}from"./web-kQdr34d8.js";var pe=a("<button>");const ue=e=>{const r=()=>{switch(e.type){case"primary":return"bg-blue-500 text-white";case"secondary":return"bg-gray-500 text-white";case"warning":return"bg-yellow-500 text-black";case"danger":return"bg-red-500 text-white";case"back":return"bg-gray-300 text-black";case"cute":return"bg-pink-500 text-white";default:return"bg-blue-500 text-white"}};return(()=>{var t=pe();return D(t,"click",e.onClick,!0),l(t,()=>e.label),ce(n=>{var o=`px-4 py-2 rounded ${e.disabled?"bg-gray-200 text-gray-400":r()}`,g=e.disabled;return o!==n.e&&M(t,n.e=o),g!==n.t&&(t.disabled=n.t=g),n},{e:void 0,t:void 0}),t})()};de(["click"]);var be=a('<div class="grid grid-cols-10 gap-2 items-center"><label class="col-start-1 col-end-4"></label><div class="rounded border-2 border-dashed border-pink-300 px-4 py-2 col-start-4 col-end-11"><input type=file multiple class="w-full bg-pink-300 py-2 rounded">'),ge=a('<div class="rounded border-2 border-dashed border-pink-300 px-4 py-2"><input type=file multiple class="w-full bg-pink-300 py-2 rounded">');const me=e=>N(()=>N(()=>!!e.label)()?(()=>{var r=be(),t=r.firstChild,n=t.nextSibling,o=n.firstChild;return l(t,()=>e.label),D(o,"change",e.onChange),r})():(()=>{var r=ge(),t=r.firstChild;return D(t,"change",e.onChange),r})());var xe=a('<div class="grid grid-cols-10 gap-2 items-center"><label class="col-start-1 col-end-4"></label><input type=text class="rounded border-2 border-dashed border-pink-300 p-4 col-start-4 col-end-11">'),he=a('<input type=text class="rounded border-2 border-dashed border-pink-300 p-4">');const ye=e=>N(()=>N(()=>!!e.label)()?(()=>{var r=xe(),t=r.firstChild,n=t.nextSibling;return l(t,()=>e.label),n.addEventListener("change",o=>e.onChange(o.target.value)),r})():(()=>{var r=he();return r.addEventListener("change",t=>e.onChange(t.target.value)),r})());var ve=a("<div>"),$e=a('<svg class="animate-spin h-5 w-5 text-blue-500"xmlns=http://www.w3.org/2000/svg fill=none viewBox="0 0 24 24"><circle class=opacity-25 cx=12 cy=12 r=10 stroke=currentColor stroke-width=4></circle><path class=opacity-75 fill=currentColor d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">');const _e=e=>(()=>{var r=ve();return l(r,(()=>{var t=N(()=>!!e.loading);return()=>t()?$e():null})()),r})(),fe=e=>e.replace(/<!DOCTYPE[^>]*>/g,"").replace(/<!ENTITY[^>]*>/g,""),we=async(e,r)=>{const t=await e.text(),n=fe(t),g=new DOMParser().parseFromString(n,"application/xml"),m=g.getElementsByTagName("report_metadata")[0]?.getElementsByTagName("org_name")[0]?.textContent??"unknown",B=Array.from(g.getElementsByTagName("record")),w={count:0,reporter:""},C={count:0,reporter:""},d={count:0,reporter:"",ips:[],senders:[]};return B.forEach(x=>{const T=x.getElementsByTagName("source_ip")[0]?.textContent??"",S=Number(x.getElementsByTagName("count")[0]?.textContent??"0"),h=x.getElementsByTagName("header_from")[0]?.textContent??"unknown",y=x.getElementsByTagName("policy_evaluated")[0],F=y?.getElementsByTagName("dkim")[0]?.textContent,P=y?.getElementsByTagName("spf")[0]?.textContent,c=y?.getElementsByTagName("disposition")[0]?.textContent;T===r?F==="fail"||P==="fail"||c==="reject"?(C.count+=S,C.reporter=m):(w.count+=S,w.reporter=m):h.includes("")&&(d.count+=S,d.reporter=m,d.ips.push(T),!d.senders.includes(h)&&d.senders.push(h))}),{mySucceeded:w,myFailed:C,imposterResult:d}};var Ce=a('<div class="bg-pink-200 text-purple-600"><div class="my-2 w-[50vw]"></div><div class="my-2 w-[50vw]"></div><div class=my-2></div><div class=my-8></div><div class=my-8></div><h1>🚫 DMARCレポ 怪しいやつ～ 💀</h1><div class=my-2></div><div class="overflow-x-auto shadow-lg rounded-2xl bg-white/80 backdrop-blur-md border border-pink-200"><table class="uppercase tracking-wide min-w-full text-sm text-white bg-red-600"><thead><tr><th class="px-4 py-3 text-left">数</th><th class="px-4 py-3 text-left">送信先IP</th><th class="px-4 py-3 text-left">送信元IP</th><th class="px-4 py-3 text-left">送信元ドメイン</th></tr></thead><tbody class=rounded></tbody></table></div><p></p><div class=my-8></div><h1>✅ DMARCレポ うちの大丈夫なやつ～ 😊</h1><div class=my-2></div><div class="w-[50%] overflow-x-auto shadow-lg rounded-2xl bg-white/80 backdrop-blur-md border border-blue-200"><table class="uppercase tracking-wide min-w-full text-sm text-white bg-blue-500"><thead><tr><th class="px-4 py-3 text-left">数</th><th class="px-4 py-3 text-left w-md">送信先IP</th></tr></thead><tbody></tbody></table></div><p></p><div class=my-8></div><h1>❌️ DMARCレポ うちのダメだったやつ～ 😭</h1><div class=my-2></div><div class="w-[50%] overflow-x-auto shadow-lg rounded-2xl bg-white/80 backdrop-blur-md border border-yellow-200"><table class="uppercase tracking-wide min-w-full text-sm text-red-800 bg-yellow-500"><thead><tr><th class="px-4 py-3 text-left">数</th><th class="px-4 py-3 text-left w-md">送信先IP</th></tr></thead><tbody></tbody></table></div><p>'),Se=a('<tr><td class="px-4 py-2"></td><td class="px-4 py-2 w-md"></td><td class="px-4 py-2 w-lg"></td><td class="px-4 py-2 w-md">'),V=a('<tr><td class="px-4 py-2"></td><td class="px-4 py-2 w-md">');function Ee(){const[e,r]=u(null),[t,n]=u(""),[o,g]=u([]),[A,m]=u(""),[B,w]=u([]),[C,d]=u(""),[x,T]=u([]),[S,h]=u(""),[y,F]=u(!1),P=async c=>{if(!c)return;const v=c.target;if(!v.files)return;F(!0);const $=[],k=[],_=[];for(const R of Array.from(v.files)){const p=await we(R,t());p&&(p.mySucceeded.count>0&&$.push(p.mySucceeded),p.myFailed.count>0&&k.push(p.myFailed),p.imposterResult.count>0&&_.push(p.imposterResult))}g($),$.length===0?m("なかった～😭"):m(""),w(k),k.length===0?d("なかった～😊"):d(""),T(_),_.length===0?h("なかった～😎"):h(""),F(!1)};return(()=>{var c=Ce(),v=c.firstChild,$=v.nextSibling,k=$.nextSibling,_=k.nextSibling,R=_.nextSibling,p=R.nextSibling,X=p.nextSibling,L=X.nextSibling,q=L.firstChild,G=q.firstChild,J=G.nextSibling,j=L.nextSibling,K=j.nextSibling,Q=K.nextSibling,U=Q.nextSibling,z=U.nextSibling,W=z.firstChild,Z=W.firstChild,ee=Z.nextSibling,H=z.nextSibling,te=H.nextSibling,le=te.nextSibling,re=le.nextSibling,O=re.nextSibling,ne=O.firstChild,se=ne.firstChild,ie=se.nextSibling,ae=O.nextSibling;return l(v,I(me,{label:"もらったレポート",onChange:r})),l($,I(ye,{label:"うちのIP",onChange:s=>n(s)})),l(c,I(ue,{label:"✨️チェックするよ～",type:"cute",get disabled(){return e()===null||t()===""||y()},onClick:()=>P(e())}),_),l(c,I(_e,{get loading(){return y()}}),R),l(J,()=>x().map((s,E)=>(()=>{var i=Se(),b=i.firstChild,f=b.nextSibling,Y=f.nextSibling,oe=Y.nextSibling;return M(i,`border-b border-pink-100 transition-colors duration-200 text-red-800 hover:bg-pink-50 ${E%2===0?"bg-red-100":"bg-red-200"}`),l(b,()=>s.count),l(f,()=>s.reporter),l(Y,()=>s.ips.join(", ")),l(oe,()=>s.senders?.join(", ")),i})())),l(j,S),l(ee,()=>o().map((s,E)=>(()=>{var i=V(),b=i.firstChild,f=b.nextSibling;return M(i,`border-b border-pink-100 transition-colors duration-200 text-blue-800 hover:bg-blue-50 ${E%2===0?"bg-blue-100":"bg-blue-200"}`),l(b,()=>s.count),l(f,()=>s.reporter),i})())),l(H,A),l(ie,()=>B().map((s,E)=>(()=>{var i=V(),b=i.firstChild,f=b.nextSibling;return M(i,`border-b border-pink-100 transition-colors duration-200 text-red-800 hover:bg-yellow-50 ${E%2===0?"bg-yellow-100":"bg-yellow-200"}`),l(b,()=>s.count),l(f,()=>s.reporter),i})())),l(ae,C),c})()}export{Ee as default};
